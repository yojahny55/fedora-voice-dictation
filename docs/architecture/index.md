# Fedora Voice Dictation - Full-Stack Architecture Document

## Table of Contents

- [Fedora Voice Dictation - Full-Stack Architecture Document](#table-of-contents)
  - [Introduction](./introduction.md)
    - [Overview](./introduction.md#overview)
    - [Architectural Principles](./introduction.md#architectural-principles)
    - [Architecture Evolution Timeline](./introduction.md#architecture-evolution-timeline)
    - [User Journey â†’ Architecture Mapping](./introduction.md#user-journey-architecture-mapping)
    - [How to Read This Document](./introduction.md#how-to-read-this-document)
    - [Testing Philosophy](./introduction.md#testing-philosophy)
    - [Starter Template or Existing Project](./introduction.md#starter-template-or-existing-project)
    - [Documentation Note: Template Adaptation](./introduction.md#documentation-note-template-adaptation)
    - [Change Log](./introduction.md#change-log)
  - [High Level Architecture](./high-level-architecture.md)
    - [Technical Summary](./high-level-architecture.md#technical-summary)
    - [Platform and Infrastructure Choice](./high-level-architecture.md#platform-and-infrastructure-choice)
    - [Repository Structure](./high-level-architecture.md#repository-structure)
    - [High Level Architecture Diagrams](./high-level-architecture.md#high-level-architecture-diagrams)
      - [Layer Architecture Diagram](./high-level-architecture.md#layer-architecture-diagram)
      - [Dictation Session Sequence Diagram](./high-level-architecture.md#dictation-session-sequence-diagram)
    - [Threading Architecture](./high-level-architecture.md#threading-architecture)
    - [Latency Budget and Performance Targets](./high-level-architecture.md#latency-budget-and-performance-targets)
    - [Error Handling Architecture](./high-level-architecture.md#error-handling-architecture)
    - [Configuration Schema](./high-level-architecture.md#configuration-schema)
    - [Dependency Injection and Component Wiring](./high-level-architecture.md#dependency-injection-and-component-wiring)
    - [Decision Gates and Migration Paths](./high-level-architecture.md#decision-gates-and-migration-paths)
    - [Architectural Patterns](./high-level-architecture.md#architectural-patterns)
  - [Tech Stack](./tech-stack.md)
    - [Technology Stack Table](./tech-stack.md#technology-stack-table)
    - [CUDA + PyTorch Compatibility Matrix](./tech-stack.md#cuda-pytorch-compatibility-matrix)
    - [Critical Dependencies Detail](./tech-stack.md#critical-dependencies-detail)
    - [Dependency Installation (Correct Order)](./tech-stack.md#dependency-installation-correct-order)
    - [Runtime Dependencies (requirements.txt)](./tech-stack.md#runtime-dependencies-requirementstxt)
    - [Development Dependencies (requirements-dev.txt)](./tech-stack.md#development-dependencies-requirements-devtxt)
    - [CI/CD Enforcement](./tech-stack.md#cicd-enforcement)
    - [Technology Alternatives Considered](./tech-stack.md#technology-alternatives-considered)
    - [Dependency Update Strategy](./tech-stack.md#dependency-update-strategy)
    - [RPM Packaging Dependencies](./tech-stack.md#rpm-packaging-dependencies)
    - [Future: Flatpak Distribution (Phase 2)](./tech-stack.md#future-flatpak-distribution-phase-2)
  - [Data Models](./data-models.md)
    - [Configuration Data Model](./data-models.md#configuration-data-model)
    - [History/Session Data Model](./data-models.md#historysession-data-model)
    - [Internal Data Structures](./data-models.md#internal-data-structures)
    - [Data Flow Diagrams](./data-models.md#data-flow-diagrams)
    - [Data Validation and Integrity](./data-models.md#data-validation-and-integrity)
    - [Data Persistence Strategy](./data-models.md#data-persistence-strategy)
  - [Components](./components.md)
    - [Component Catalog](./components.md#component-catalog)
    - [Audio Components](./components.md#audio-components)
      - [1. AudioCapture (src/audio/capture.py)](./components.md#1-audiocapture-srcaudiocapturepy)
      - [2. VADProcessor (src/audio/vad.py)](./components.md#2-vadprocessor-srcaudiovadpy)
      - [3. CircularAudioBuffer (src/audio/buffer.py)](./components.md#3-circularaudiobuffer-srcaudiobufferpy)
    - [Transcription Components](./components.md#transcription-components)
      - [4. WhisperEngine (src/transcription/whisper_engine.py)](./components.md#4-whisperengine-srctranscriptionwhisperenginepy)
      - [5. ModelManager (src/transcription/model_manager.py)](./components.md#5-modelmanager-srctranscriptionmodelmanagerpy)
      - [6. ModelDownloader (src/transcription/model_downloader.py)](./components.md#6-modeldownloader-srctranscriptionmodeldownloaderpy)
    - [Wayland Integration Components](./components.md#wayland-integration-components)
      - [7. TextInjection (src/wayland/text_injection.py)](./components.md#7-textinjection-srcwaylandtextinjectionpy)
      - [8. TextInputProtocol (src/wayland/text_input_protocol.py)](./components.md#8-textinputprotocol-srcwaylandtextinputprotocolpy)
      - [9. ClipboardFallback (src/wayland/clipboard_fallback.py)](./components.md#9-clipboardfallback-srcwaylandclipboardfallbackpy)
      - [10. WindowFocus (src/wayland/window_focus.py)](./components.md#10-windowfocus-srcwaylandwindowfocuspy)
    - [UI Components (PyQt5)](./components.md#ui-components-pyqt5)
      - [11. SystemTray (src/ui/system_tray.py)](./components.md#11-systemtray-srcuisystemtraypy)
      - [12. SettingsWindow (src/ui/settings_window.py)](./components.md#12-settingswindow-srcuisettingswindowpy)
      - [13. HistoryViewer (src/ui/history_viewer.py)](./components.md#13-historyviewer-srcuihistoryviewerpy)
      - [14. AudioIndicator (src/ui/audio_indicator.py)](./components.md#14-audioindicator-srcuiaudioindicatorpy)
    - [Core Components](./components.md#core-components)
      - [15. StateMachine (src/core/state_machine.py)](./components.md#15-statemachine-srccorestatemachinepy)
      - [16. ConfigManager (src/core/config.py)](./components.md#16-configmanager-srccoreconfigpy)
      - [17. HistoryManager (src/core/history.py)](./components.md#17-historymanager-srccorehistorypy)
      - [18. HotkeyManager (src/core/hotkey.py)](./components.md#18-hotkeymanager-srccorehotkeypy)
    - [Utility Components](./components.md#utility-components)
      - [19. Logger (src/utils/logger.py)](./components.md#19-logger-srcutilsloggerpy)
      - [20. NotificationManager (src/utils/notifications.py)](./components.md#20-notificationmanager-srcutilsnotificationspy)
      - [21. ErrorHandler (src/utils/error_handler.py)](./components.md#21-errorhandler-srcutilserrorhandlerpy)
    - [Component Lifecycle](./components.md#component-lifecycle)
    - [Component Communication Patterns](./components.md#component-communication-patterns)
  - [Testing Strategy](./testing-strategy.md)
    - [Testing Philosophy](./testing-strategy.md#testing-philosophy)
    - [Test Categories](./testing-strategy.md#test-categories)
    - [Unit Testing](./testing-strategy.md#unit-testing)
      - [Unit Test Structure](./testing-strategy.md#unit-test-structure)
      - [Example Unit Test: AudioCapture](./testing-strategy.md#example-unit-test-audiocapture)
      - [Example Unit Test: StateMachine](./testing-strategy.md#example-unit-test-statemachine)
      - [Mocking Guidelines](./testing-strategy.md#mocking-guidelines)
    - [Integration Testing](./testing-strategy.md#integration-testing)
      - [Integration Test Categories](./testing-strategy.md#integration-test-categories)
    - [Performance Benchmarking](./testing-strategy.md#performance-benchmarking)
      - [Benchmark Suite](./testing-strategy.md#benchmark-suite)
    - [Test Fixtures and Data](./testing-strategy.md#test-fixtures-and-data)
    - [CI/CD Pipeline](./testing-strategy.md#cicd-pipeline)
    - [Manual Testing Procedures](./testing-strategy.md#manual-testing-procedures)
    - [Test Coverage Goals](./testing-strategy.md#test-coverage-goals)
    - [Testing Anti-Patterns to Avoid](./testing-strategy.md#testing-anti-patterns-to-avoid)
  - [Coding Standards](./coding-standards.md)
    - [Overview](./coding-standards.md#overview)
    - [Python Style Guide](./coding-standards.md#python-style-guide)
      - [Base Standard: PEP 8 + Black Formatting](./coding-standards.md#base-standard-pep-8-black-formatting)
      - [Line Length and Wrapping](./coding-standards.md#line-length-and-wrapping)
      - [Imports](./coding-standards.md#imports)
    - [Type Hints Policy](./coding-standards.md#type-hints-policy)
      - [Function Signatures](./coding-standards.md#function-signatures)
      - [Class Attributes](./coding-standards.md#class-attributes)
      - [Qt Signal Types](./coding-standards.md#qt-signal-types)
      - [Union and Optional](./coding-standards.md#union-and-optional)
      - [TypedDict for Complex Dicts](./coding-standards.md#typeddict-for-complex-dicts)
      - [NumPy Array Type Hints](./coding-standards.md#numpy-array-type-hints)
      - [Mypy Configuration](./coding-standards.md#mypy-configuration)
    - [Naming Conventions](./coding-standards.md#naming-conventions)
      - [Files and Modules](./coding-standards.md#files-and-modules)
      - [Classes](./coding-standards.md#classes)
      - [Functions and Methods](./coding-standards.md#functions-and-methods)
      - [Constants](./coding-standards.md#constants)
      - [Qt Signals and Slots](./coding-standards.md#qt-signals-and-slots)
      - [Variables](./coding-standards.md#variables)
    - [Docstring Standards](./coding-standards.md#docstring-standards)
      - [Function Docstrings](./coding-standards.md#function-docstrings)
      - [Class Docstrings](./coding-standards.md#class-docstrings)
      - [Property Docstrings](./coding-standards.md#property-docstrings)
      - [Module Docstrings](./coding-standards.md#module-docstrings)
    - [Error Handling Patterns](./coding-standards.md#error-handling-patterns)
      - [Custom Exception Hierarchy](./coding-standards.md#custom-exception-hierarchy)
      - [Exception Handling Best Practices](./coding-standards.md#exception-handling-best-practices)
    - [Qt-Specific Conventions](./coding-standards.md#qt-specific-conventions)
      - [Thread Safety Rules](./coding-standards.md#thread-safety-rules)
      - [Signal/Slot Connections](./coding-standards.md#signalslot-connections)
      - [Thread Safety with QMutex](./coding-standards.md#thread-safety-with-qmutex)
      - [QThread Usage](./coding-standards.md#qthread-usage)
    - [File and Module Organization](./coding-standards.md#file-and-module-organization)
      - [Project Structure](./coding-standards.md#project-structure)
      - [Module-Level Exports](./coding-standards.md#module-level-exports)
      - [One Class Per File](./coding-standards.md#one-class-per-file)
    - [Code Review Requirements](./coding-standards.md#code-review-requirements)
      - [Pre-Commit Checklist](./coding-standards.md#pre-commit-checklist)
      - [Pull Request Requirements](./coding-standards.md#pull-request-requirements)
      - [Code Review Criteria](./coding-standards.md#code-review-criteria)
    - [Linting Configuration](./coding-standards.md#linting-configuration)
      - [Ruff Configuration](./coding-standards.md#ruff-configuration)
      - [Black Configuration](./coding-standards.md#black-configuration)
    - [Performance Guidelines](./coding-standards.md#performance-guidelines)
      - [Critical Path Optimization](./coding-standards.md#critical-path-optimization)
      - [Avoid Blocking Main Thread](./coding-standards.md#avoid-blocking-main-thread)
      - [GPU Memory Management](./coding-standards.md#gpu-memory-management)
    - [Logging Standards](./coding-standards.md#logging-standards)
      - [Logger Configuration](./coding-standards.md#logger-configuration)
      - [Log Levels](./coding-standards.md#log-levels)
      - [Logging Best Practices](./coding-standards.md#logging-best-practices)
      - [Logger Setup (src/utils/logger.py)](./coding-standards.md#logger-setup-srcutilsloggerpy)
    - [Git Commit Message Standards](./coding-standards.md#git-commit-message-standards)
      - [Format](./coding-standards.md#format)
      - [Commit Types](./coding-standards.md#commit-types)
      - [Scopes](./coding-standards.md#scopes)
